# MAPMEM Driver Exploit 技术文档

## 概述

MAPMEM驱动漏洞利用模块是针对一类存在物理内存映射漏洞的Windows驱动程序实现的通用利用框架。该模块支持Gigabyte GDRV（CVE-2018-19320）和CODESYS SYSDRV3S（CVE-2022-22516）等基于MAPMEM机制的驱动程序。

## 漏洞原理

### MAPMEM机制
这类驱动程序通过提供IOCTL接口，允许用户态程序：
1. 将任意物理地址映射到用户态虚拟地址空间
2. 通过映射的内存区域进行读写操作
3. 部分驱动还提供虚拟地址到物理地址的转换功能

### 漏洞成因
- 缺少对物理地址范围的合法性检查
- 未验证调用者权限
- 映射后未正确清理
- 允许映射任意物理内存区域（包括内核关键数据结构）
